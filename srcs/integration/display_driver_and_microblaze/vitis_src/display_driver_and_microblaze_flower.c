#include <stdio.h>
#include "xparameters.h"
#include "xil_printf.h"
#include "platform.h"
#include "sleep.h"

//#include "PmodDHB1.h"		// H-Bridge driver
#include "xiic.h"			    // I2C driver
#include "xiic_l.h"


// ***************************** Definitions **********************************

#define IIC_BASE_ADDRESS	XPAR_AXI_IIC_0_BASEADDR		// Base memory address for IIC IP
#define IIC_DEVICE_ID		XPAR_AXI_IIC_0_DEVICE_ID	// IIC IP ID
#define ENCODER_ID			0x36						// Defines the address of the IIC Slave device (encoder) on the IIC bus

#define NUM_LEDS   32
#define NUM_ANGLES   64
#define LED_ARRAY_LEN   (NUM_LEDS * NUM_ANGLES)     // Size of LED array



// ************************** Function Prototypes ******************************

void GetAngle(void);
void CorrectAngle(void);
void ReadIIC(XIic* InstancePtr, u8 reg, u8 *Data, int nData);

void write_led_values( volatile u32* config_addr, volatile u32* register_addr, u8* led_array, unsigned int led_array_len );



// ************************** Variable Definitions *****************************
volatile u32 *DISPLAY_CONFIG = (volatile u32*)XPAR_DISPLAY_DRIVER_0_BASEADDR;
volatile u32 *DISPLAY_REGISTER = (volatile u32 *)((u32)XPAR_DISPLAY_DRIVER_0_BASEADDR + 4);

const int debug_encoder = 0;	// Debug switch

const u8 kDeadzone = 2;			// # angles on either side of zero that will be clamped to zero

XIic i2c;						// I2C driver instance

u8 status_byte = 0;				// For reading status register from encoder
u8 angle_high_byte = 0;			// For reading raw angle fropm encoder
u8 angle_low_byte = 0;

unsigned int raw_angle = 0;		// (angle_high_byte << 8) || angle_low_byte
float deg_angle = 0.0;			// raw angle in degrees (360/4096 * [value between 0-4095])
float start_angle = 0.0;		// For zeroing encoder on startup
float last_angle = 0.0;			// For tracking rollover from 360 - 0 degrees
float first_angle_after_update = 0.0; 	// For calculating when to update the strip next

float corrected_angle = 0.0;	// Usable angle for updating LED strip

float update_width;				// 360/NUM_ANGLES - angular distance between LED strip updates
const float kEarlyUpdate = 1;	// How much before update_width to send the next update

u8 skipped_angle = 0; 			// Used to compensate for a missed angle. This condition is checked at zero degrees.
								// == 0: all angles counted, == 1: skipped an angle somewhere

int main() {

    init_platform();

    XIic_Config *i2c_config;
    int Status;

    xil_printf("config space: %x\n", *DISPLAY_CONFIG);
    xil_printf("register addr: %x\n", DISPLAY_REGISTER);

    //u8 led_array[LED_ARRAY_LEN] = { 0, 0, 0, 0, 46, 29, 13, 13, 30, 0, 0, 0, 8, 12, 12, 8, 0, 0, 0, 45, 12, 12, 12, 46, 0, 0, 0, 13, 29, 29, 29, 0, 0, 0, 0, 0, 0, 10, 10, 10, 10, 0, 0, 0, 47, 14, 10, 31, 0, 0, 0, 10, 15, 10, 0, 0, 0, 47, 26, 31, 31, 31, 0, 0, 0, 0, 0, 0, 0, 47, 47, 6, 11, 6, 0, 0, 0, 27, 11, 6, 47, 47, 0, 0, 47, 27, 27, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 26, 21, 42, 0, 0, 0, 0, 18, 19, 19, 18, 0, 0, 0, 59, 19, 19, 19, 59, 0, 0, 0, 19, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 36, 0, 0, 0, 37, 56, 56, 37, 0, 0, 0, 0, 53, 53, 53, 0, 0, 0, 37, 53, 53, 58, 0, 0, 0, 0, 0, 0, 45, 44, 44, 44, 0, 0, 0, 44, 44, 44, 44, 0, 0, 0, 0, 60, 44, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46, 29, 28, 24, 0, 0, 0, 46, 12, 28, 28, 12, 0, 0, 0, 46, 28, 28, 28, 46, 0, 0, 0, 28, 29, 29, 46, 0, 0, 0, 0, 0, 0, 9, 14, 14, 9, 0, 0, 0, 9, 14, 14, 9, 0, 0, 0, 0, 14, 14, 9, 0, 0, 0, 10, 30, 30, 30, 0, 0, 0, 0, 0, 0, 0, 0, 10, 11, 6, 47, 0, 0, 47, 6, 11, 6, 0, 0, 0, 27, 11, 11, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21, 22, 0, 0, 0, 0, 0, 2, 23, 2, 43, 0, 0, 0, 19, 19, 19, 18, 39, 0, 0, 0, 23, 39, 39, 0, 0, 0, 0, 0, 0, 0, 21, 42, 42, 41, 37, 37, 58, 0, 0, 0, 37, 37, 37, 37, 0, 0, 0, 58, 49, 49, 33, 0, 0, 0, 58, 53, 53, 54, 58, 0, 0, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 44, 45, 45, 45, 0, 0, 0, 0, 0, 0, 30, 13, 13, 13, 9, 0, 0, 0, 9, 13, 13, 13, 0, 0, 0, 47, 8, 13, 13, 0, 0, 0, 30, 29, 29, 29, 46, 0, 0, 0, 0, 0, 0, 31, 10, 11, 10, 0, 0, 0, 31, 10, 10, 26, 0, 0, 0, 10, 15, 10, 47, 0, 0, 47, 26, 31, 31, 0, 0, 0, 0, 0, 21, 21, 0, 0, 0, 27, 6, 23, 22, 22, 0, 0, 0, 2, 7, 7, 47, 47, 0, 0, 22, 23, 27, 22, 0, 0, 0, 0, 0, 0, 0, 0, 21, 26, 42, 38, 37, 42, 0, 0, 0, 38, 38, 34, 34, 33, 0, 0, 0, 54, 33, 34, 33, 0, 0, 0, 59, 38, 54, 54, 0, 0, 0, 0, 0, 0, 0, 41, 44, 40, 0, 0, 0, 0, 60, 60, 60, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29, 28, 28, 28, 0, 0, 0, 0, 44, 44, 45, 0, 0, 0, 44, 44, 44, 44, 0, 0, 0, 45, 45, 45, 45, 0, 0, 0, 0, 0, 0, 0, 47, 13, 13, 13, 30, 0, 0, 0, 8, 12, 12, 8, 0, 0, 0, 29, 12, 12, 12, 46, 0, 0, 0, 28, 29, 29, 46, 0, 0, 0, 0, 0, 47, 10, 10, 14, 10, 0, 0, 0, 10, 14, 10, 31, 0, 0, 0, 10, 14, 10, 31, 0, 0, 47, 15, 31, 31, 31, 0, 0, 0, 0, 0, 0, 0, 0, 47, 6, 11, 6, 6, 0, 0, 47, 7, 11, 7, 27, 0, 0, 43, 27, 27, 27, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 26, 26, 21, 42, 0, 0, 0, 59, 18, 35, 18, 38, 0, 0, 0, 39, 19, 35, 18, 59, 0, 0, 0, 35, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 41, 0, 0, 0, 0, 56, 56, 0, 0, 0, 0, 57, 56, 56, 0, 0, 0, 0, 57, 57, 57, 0, 0, 0, 0, 0, 0, 0, 29, 44, 44, 44, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 45, 44, 44, 45, 0, 0, 0, 45, 45, 45, 0, 0, 0, 0, 0, 0, 0, 0, 46, 29, 29, 29, 46, 0, 0, 0, 12, 12, 12, 29, 0, 0, 0, 28, 12, 12, 12, 0, 0, 0, 0, 28, 29, 29, 46, 0, 0, 0, 0, 0, 0, 10, 14, 14, 9, 0, 0, 0, 10, 14, 14, 10, 47, 0, 47, 47, 14, 14, 10, 0, 0, 0, 10, 31, 31, 47, 0, 0, 0, 0, 0, 0, 0, 0, 26, 11, 6, 47, 0, 0, 0, 27, 6, 11, 26, 0, 0, 0, 6, 27, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21, 22, 21, 42, 0, 0, 0, 39, 19, 19, 18, 0, 0, 0, 0, 19, 19, 19, 19, 0, 0, 0, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 37, 0, 0, 0, 37, 53, 53, 37, 0, 0, 0, 37, 37, 49, 32, 58, 0, 0, 0, 53, 53, 37, 0, 0, 0, 0, 0, 0, 45, 44, 44, 44, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 29, 29, 28, 29, 0, 0, 0, 28, 28, 28, 46, 0, 0, 0, 28, 28, 28, 28, 0, 0, 0, 45, 45, 45, 46, 46, 0, 0, 0, 0, 0, 0, 9, 13, 13, 26, 0, 0, 0, 9, 13, 13, 9, 0, 0, 0, 47, 14, 13, 13, 0, 0, 0, 47, 30, 30, 30, 0, 0, 0, 0, 0, 0, 0, 47, 10, 11, 10, 47, 0, 0, 47, 10, 11, 6, 0, 0, 0, 31, 11, 11, 31, 0, 0, 0, 10, 31, 31, 0, 0, 0, 0, 0, 21, 42, 42, 0, 0, 0, 27, 23, 23, 2, 43, 0, 0, 23, 3, 23, 2, 23, 0, 0, 43, 23, 23, 23, 43, 0, 0, 0, 0, 0, 0, 0, 21, 26, 41, 37, 37, 37, 42, 0, 0, 59, 33, 33, 33, 42, 0, 0, 0, 58, 33, 33, 33, 0, 0, 0, 0, 33, 53, 54, 58, 0, 0, 0, 0, 0, 0, 41, 44, 44, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29, 28, 28, 28, 46, 0, 0, 0, 28, 28, 28, 0, 0, 0, 45, 44, 44, 28, 0, 0, 0, 0, 45, 45, 45, 0, 0, 0, 0, 0, 0, 0, 47, 13, 13, 13, 46, 0, 0, 0, 30, 13, 13, 13, 0, 0, 0, 46, 12, 12, 12, 46, 0, 0, 0, 13, 29, 29, 46, 0, 0, 0, 0, 0, 0, 31, 10, 10, 10, 0, 0, 0, 10, 11, 15, 10, 0, 0, 0, 31, 10, 10, 31, 0, 0, 0, 10, 31, 31, 0, 0, 0, 0, 0, 0, 21, 0, 0, 0, 27, 7, 7, 2, 0, 0, 0, 0, 6, 7, 22, 43, 0, 0, 6, 7, 27, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 26, 42, 38, 21, 0, 0, 0, 0, 38, 34, 34, 18, 0, 0, 0, 59, 34, 34, 34, 43, 0, 0, 0, 38, 39, 39, 38, 0, 0, 0, 0, 0, 0, 0, 41, 41, 40, 41, 0, 0, 0, 0, 56, 56, 0, 0, 0, 0, 57, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 44, 25, 0, 0, 0, 0, 44, 44, 45, 45, 0, 0, 45, 44, 44, 44, 0, 0, 0, 45, 45, 45, 45, 0, 0, 0, 0, 0, 0, 0, 46, 29, 13, 13, 30, 0, 0, 0, 8, 12, 12, 8, 0, 0, 0, 45, 12, 12, 12, 46, 0, 0, 0, 13, 29, 29, 29, 0, 0, 0, 0, 0, 0, 10, 10, 10, 10, 0, 0, 0, 47, 14, 14, 31, 0, 0, 0, 10, 15, 10, 0, 0, 0, 0, 26, 31, 31, 0, 0, 0, 0, 0, 0, 0, 0, 47, 47, 6, 11, 6, 0, 0, 0, 6, 11, 6, 6, 47, 0, 0, 22, 27, 27, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 26, 26, 42, 0, 0, 0, 0, 18, 35, 35, 18, 0, 0, 0, 59, 19, 19, 19, 59, 0, 0, 0, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 36, 0, 0, 0, 37, 56, 56, 0, 0, 0, 0, 37, 53, 53, 53, 0, 0, 0, 37, 53, 57, 58, 0, 0, 0, 0, 0, 0, 45, 44, 44, 44, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 60, 44, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46, 29, 28, 24, 0, 0, 0, 46, 12, 12, 12, 12, 0, 0, 0, 46, 12, 28, 28, 46, 0, 0, 0, 29, 29, 29, 46, 0, 0, 0, 0, 0, 0, 9, 14, 14, 9, 0, 0, 0, 9, 14, 14, 9, 0, 0, 0, 10, 14, 14, 10, 0, 0, 0, 0, 30, 30, 30, 47, 0, 0, 0, 0, 0, 0, 0, 10, 11, 6, 47, 0, 0, 47, 6, 11, 6, 0, 0, 0, 27, 11, 11, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21, 22, 0, 0, 0, 0, 0, 2, 23, 23, 43, 0, 0, 0, 39, 19, 19, 18, 39, 0, 0, 0, 23, 39, 39, 0, 0, 0, 0, 0, 0, 0, 21, 0, 42, 41, 37, 37, 58, 0, 0, 0, 37, 37, 37, 37, 0, 0, 0, 33, 49, 49, 33, 0, 0, 0, 33, 33, 53, 54, 0, 0, 0, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 28, 28, 28, 45, 0, 0, 0, 44, 45, 45, 46, 0, 0, 0, 0, 0, 0, 30, 30, 13, 13, 9, 0, 0, 0, 9, 13, 13, 9, 46, 0, 0, 47, 13, 13, 9, 0, 0, 0, 0, 25, 29, 29, 46, 0, 0, 0, 0, 0, 0, 31, 10, 11, 10, 0, 0, 0, 47, 10, 10, 26, 0, 0, 0, 10, 11, 10, 47, 0, 0, 47, 10, 31, 31, 0, 0, 0, 0, 0, 21, 21, 0, 0, 0, 0, 6, 23, 7, 22, 0, 0, 0, 7, 7, 7, 23, 0, 0, 0, 22, 27, 27, 22, 0, 0, 0, 0, 0, 0, 0, 0, 21, 26, 42, 37, 37, 42, 0, 0, 0, 0, 37, 34, 34, 38, 0, 0, 0, 34, 33, 34, 33, 0, 0, 0, 38, 38, 38, 38, 0, 0, 0, 0, 0, 0, 0, 41, 44, 40, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29, 28, 28, 28, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 45, 45, 0, 0, 0, 0, 0, 0, 0, 0, 47, 13, 13, 13, 30, 0, 0, 0, 8, 12, 12, 25, 0, 0, 0, 29, 12, 12, 12, 0, 0, 0, 0, 12, 29, 29, 46, 0 };
    //u8 led_array[LED_ARRAY_LEN] = {0, 0, 0, 0, 46, 29, 13, 13, 30, 0, 0, 0, 8, 12, 12, 8, 0, 0, 0, 45, 12, 12, 12, 46, 0, 0, 0, 13, 29, 29, 29, 0, 0, 0, 0, 0, 0, 10, 10, 10, 10, 0, 0, 0, 47, 14, 10, 31, 0, 0, 0, 10, 15, 10, 0, 0, 0, 47, 26, 31, 31, 31, 0, 0, 0, 0, 0, 0, 0, 47, 47, 6, 11, 6, 0, 0, 0, 27, 11, 6, 47, 47, 0, 0, 47, 27, 27, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 26, 21, 42, 0, 0, 0, 0, 18, 19, 19, 18, 0, 0, 0, 59, 19, 19, 19, 59, 0, 0, 0, 19, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 36, 0, 0, 0, 37, 56, 56, 37, 0, 0, 0, 0, 53, 53, 53, 0, 0, 0, 37, 53, 53, 58, 0, 0, 0, 0, 0, 0, 45, 44, 44, 44, 0, 0, 0, 44, 44, 44, 44, 0, 0, 0, 0, 60, 44, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46, 29, 28, 24, 0, 0, 0, 46, 12, 28, 28, 12, 0, 0, 0, 46, 28, 28, 28, 46, 0, 0, 0, 28, 29, 29, 46, 0, 0, 0, 0, 0, 0, 9, 14, 14, 9, 0, 0, 0, 9, 14, 14, 9, 0, 0, 0, 0, 14, 14, 9, 0, 0, 0, 10, 30, 30, 30, 0, 0, 0, 0, 0, 0, 0, 0, 10, 11, 6, 47, 0, 0, 47, 6, 11, 6, 0, 0, 0, 27, 11, 11, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21, 22, 0, 0, 0, 0, 0, 2, 23, 2, 43, 0, 0, 0, 19, 19, 19, 18, 39, 0, 0, 0, 23, 39, 39, 0, 0, 0, 0, 0, 0, 0, 21, 42, 42, 41, 37, 37, 58, 0, 0, 0, 37, 37, 37, 37, 0, 0, 0, 58, 49, 49, 33, 0, 0, 0, 58, 53, 53, 54, 58, 0, 0, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 44, 45, 45, 45, 0, 0, 0, 0, 0, 0, 30, 13, 13, 13, 9, 0, 0, 0, 9, 13, 13, 13, 0, 0, 0, 47, 8, 13, 13, 0, 0, 0, 30, 29, 29, 29, 46, 0, 0, 0, 0, 0, 0, 31, 10, 11, 10, 0, 0, 0, 31, 10, 10, 26, 0, 0, 0, 10, 15, 10, 47, 0, 0, 47, 26, 31, 31, 0, 0, 0, 0, 0, 21, 21, 0, 0, 0, 27, 6, 23, 22, 22, 0, 0, 0, 2, 7, 7, 47, 47, 0, 0, 22, 23, 27, 22, 0, 0, 0, 0, 0, 0, 0, 0, 21, 26, 42, 38, 37, 42, 0, 0, 0, 38, 38, 34, 34, 33, 0, 0, 0, 54, 33, 34, 33, 0, 0, 0, 59, 38, 54, 54, 0, 0, 0, 0, 0, 0, 0, 41, 44, 40, 0, 0, 0, 0, 60, 60, 60, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29, 28, 28, 28, 0, 0, 0, 0, 44, 44, 45, 0, 0, 0, 44, 44, 44, 44, 0, 0, 0, 45, 45, 45, 45, 0, 0, 0, 0, 0, 0, 0, 47, 13, 13, 13, 30, 0, 0, 0, 8, 12, 12, 8, 0, 0, 0, 29, 12, 12, 12, 46, 0, 0, 0, 28, 29, 29, 46, 0, 0, 0, 0, 0, 47, 10, 10, 14, 10, 0, 0, 0, 10, 14, 10, 31, 0, 0, 0, 10, 14, 10, 31, 0, 0, 47, 15, 31, 31, 31, 0, 0, 0, 0, 0, 0, 0, 0, 47, 6, 11, 6, 6, 0, 0, 47, 7, 11, 7, 27, 0, 0, 43, 27, 27, 27, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 26, 26, 21, 42, 0, 0, 0, 59, 18, 35, 18, 38, 0, 0, 0, 39, 19, 35, 18, 59, 0, 0, 0, 35, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 41, 0, 0, 0, 0, 56, 56, 0, 0, 0, 0, 57, 56, 56, 0, 0, 0, 0, 57, 57, 57, 0, 0, 0, 0, 0, 0, 0, 29, 44, 44, 44, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 45, 44, 44, 45, 0, 0, 0, 45, 45, 45, 0, 0, 0, 0, 0, 0, 0, 0, 46, 29, 29, 29, 46, 0, 0, 0, 12, 12, 12, 29, 0, 0, 0, 28, 12, 12, 12, 0, 0, 0, 0, 28, 29, 29, 46, 0, 0, 0, 0, 0, 0, 10, 14, 14, 9, 0, 0, 0, 10, 14, 14, 10, 47, 0, 47, 47, 14, 14, 10, 0, 0, 0, 10, 31, 31, 47, 0, 0, 0, 0, 0, 0, 0, 0, 26, 11, 6, 47, 0, 0, 0, 27, 6, 11, 26, 0, 0, 0, 6, 27, 11, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21, 22, 21, 42, 0, 0, 0, 39, 19, 19, 18, 0, 0, 0, 0, 19, 19, 19, 19, 0, 0, 0, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 37, 0, 0, 0, 37, 53, 53, 37, 0, 0, 0, 37, 37, 49, 32, 58, 0, 0, 0, 53, 53, 37, 0, 0, 0, 0, 0, 0, 45, 44, 44, 44, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 29, 29, 28, 29, 0, 0, 0, 28, 28, 28, 46, 0, 0, 0, 28, 28, 28, 28, 0, 0, 0, 45, 45, 45, 46, 46, 0, 0, 0, 0, 0, 0, 9, 13, 13, 26, 0, 0, 0, 9, 13, 13, 9, 0, 0, 0, 47, 14, 13, 13, 0, 0, 0, 47, 30, 30, 30, 0, 0, 0, 0, 0, 0, 0, 47, 10, 11, 10, 47, 0, 0, 47, 10, 11, 6, 0, 0, 0, 31, 11, 11, 31, 0, 0, 0, 10, 31, 31, 0, 0, 0, 0, 0, 21, 42, 42, 0, 0, 0, 27, 23, 23, 2, 43, 0, 0, 23, 3, 23, 2, 23, 0, 0, 43, 23, 23, 23, 43, 0, 0, 0, 0, 0, 0, 0, 21, 26, 41, 37, 37, 37, 42, 0, 0, 59, 33, 33, 33, 42, 0, 0, 0, 58, 33, 33, 33, 0, 0, 0, 0, 33, 53, 54, 58, 0, 0, 0, 0, 0, 0, 41, 44, 44, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29, 28, 28, 28, 46, 0, 0, 0, 28, 28, 28, 0, 0, 0, 45, 44, 44, 28, 0, 0, 0, 0, 45, 45, 45, 0, 0, 0, 0, 0, 0, 0, 47, 13, 13, 13, 46, 0, 0, 0, 30, 13, 13, 13, 0, 0, 0, 46, 12, 12, 12, 46, 0, 0, 0, 13, 29, 29, 46, 0, 0, 0, 0, 0, 0, 31, 10, 10, 10, 0, 0, 0, 10, 11, 15, 10, 0, 0, 0, 31, 10, 10, 31, 0, 0, 0, 10, 31, 31, 0, 0, 0, 0, 0, 0, 21, 0, 0, 0, 27, 7, 7, 2, 0, 0, 0, 0, 6, 7, 22, 43, 0, 0, 6, 7, 27, 27, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 26, 42, 38, 21, 0, 0, 0, 0, 38, 34, 34, 18, 0, 0, 0, 59, 34, 34, 34, 43, 0, 0, 0, 38, 39, 39, 38, 0, 0, 0, 0, 0, 0, 0, 41, 41, 40, 41, 0, 0, 0, 0, 56, 56, 0, 0, 0, 0, 57, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 44, 25, 0, 0, 0, 0, 44, 44, 45, 45, 0, 0, 45, 44, 44, 44, 0, 0, 0, 45, 45, 45, 45, 0, 0, 0, 0, 0, 0, 0, 46, 29, 13, 13, 30, 0, 0, 0, 8, 12, 12, 8, 0, 0, 0, 45, 12, 12, 12, 46, 0, 0, 0, 13, 29, 29, 29, 0, 0, 0, 0, 0, 0, 10, 10, 10, 10, 0, 0, 0, 47, 14, 14, 31, 0, 0, 0, 10, 15, 10, 0, 0, 0, 0, 26, 31, 31, 0, 0, 0, 0, 0, 0, 0, 0, 47, 47, 6, 11, 6, 0, 0, 0, 6, 11, 6, 6, 47, 0, 0, 22, 27, 27, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 25, 26, 26, 42, 0, 0, 0, 0, 18, 35, 35, 18, 0, 0, 0, 59, 19, 19, 19, 59, 0, 0, 0, 39, 39, 39, 39, 0, 0, 0, 0, 0, 0, 0, 0, 41, 41, 41, 36, 0, 0, 0, 37, 56, 56, 0, 0, 0, 0, 37, 53, 53, 53, 0, 0, 0, 37, 53, 57, 58, 0, 0, 0, 0, 0, 0, 45, 44, 44, 44, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 60, 44, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 46, 29, 28, 24, 0, 0, 0, 46, 12, 12, 12, 12, 0, 0, 0, 46, 12, 28, 28, 46, 0, 0, 0, 29, 29, 29, 46, 0, 0, 0, 0, 0, 0, 9, 14, 14, 9, 0, 0, 0, 9, 14, 14, 9, 0, 0, 0, 10, 14, 14, 10, 0, 0, 0, 0, 30, 30, 30, 47, 0, 0, 0, 0, 0, 0, 0, 10, 11, 6, 47, 0, 0, 47, 6, 11, 6, 0, 0, 0, 27, 11, 11, 47, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 21, 22, 0, 0, 0, 0, 0, 2, 23, 23, 43, 0, 0, 0, 39, 19, 19, 18, 39, 0, 0, 0, 23, 39, 39, 0, 0, 0, 0, 0, 0, 0, 21, 0, 42, 41, 37, 37, 58, 0, 0, 0, 37, 37, 37, 37, 0, 0, 0, 33, 49, 49, 33, 0, 0, 0, 33, 33, 53, 54, 0, 0, 0, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 28, 28, 28, 0, 0, 0, 0, 28, 28, 28, 45, 0, 0, 0, 44, 45, 45, 46, 0, 0, 0, 0, 0, 0, 30, 30, 13, 13, 9, 0, 0, 0, 9, 13, 13, 9, 46, 0, 0, 47, 13, 13, 9, 0, 0, 0, 0, 25, 29, 29, 46, 0, 0, 0, 0, 0, 0, 31, 10, 11, 10, 0, 0, 0, 47, 10, 10, 26, 0, 0, 0, 10, 11, 10, 47, 0, 0, 47, 10, 31, 31, 0, 0, 0, 0, 0, 21, 21, 0, 0, 0, 0, 6, 23, 7, 22, 0, 0, 0, 7, 7, 7, 23, 0, 0, 0, 22, 27, 27, 22, 0, 0, 0, 0, 0, 0, 0, 0, 21, 26, 42, 37, 37, 42, 0, 0, 0, 0, 37, 34, 34, 38, 0, 0, 0, 34, 33, 34, 33, 0, 0, 0, 38, 38, 38, 38, 0, 0, 0, 0, 0, 0, 0, 41, 44, 40, 0, 0, 0, 0, 60, 60, 0, 0, 0, 0, 0, 60, 60, 60, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29, 28, 28, 28, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 44, 44, 44, 0, 0, 0, 0, 45, 45, 0, 0, 0, 0, 0, 0, 0, 0, 47, 13, 13, 13, 30, 0, 0, 0, 8, 12, 12, 25, 0, 0, 0, 29, 12, 12, 12, 0, 0, 0, 0, 12, 29, 29, 46, 0};
    //};

    u8 led_array[LED_ARRAY_LEN] =		// Manual 'flower' thing
    {
    		0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00110000, 0b00110000, 0b00110000, 0b00110000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,

    		0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00001100, 0b00001100, 0b00001100, 0b00001100, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,

			0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000011, 0b00000011, 0b00000011, 0b00000011, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,

    		0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
			0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
    		0b00111111, 0b00111111, 0b00111111, 0b00111111, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000, 0b00000000,
   };
*/

    update_width = 360.0/(float)NUM_ANGLES;
    update_width = update_width - kEarlyUpdate;

    // ************************************************************************
    // ************** INITIALIZE I2C IP ***************************************

    i2c_config = XIic_LookupConfig(IIC_DEVICE_ID);
    if (i2c_config == NULL) {
      return XST_FAILURE;
    }

    Status = XIic_CfgInitialize(&i2c, i2c_config, IIC_BASE_ADDRESS);
    if (Status != XST_SUCCESS) {
    // Start the IIC driver so that the device is enabled.

      xil_printf("XIic_CfgInitialize failed!\n");
      return XST_FAILURE;
    }
    xil_printf("XIic_CfgInitialize success!\n");

    XIic_IntrGlobalDisable(&i2c);		// Disable Global interrupt to use polled mode operation
    xil_printf("Interrupts disabled on startup.\n");

    // ************** DONE INITIALIZING ***************************************
    // ************************************************************************


    while((status_byte != 55) && (status_byte != 51))		// Ensure magnet is in correct position
    {
      ReadIIC(&i2c, 0x0B, &status_byte, 1);		// Read status reg

      if (status_byte == 23)
      {
        xil_printf("Magnet too weak, move closer.\n");
      }
      else if ((status_byte == 55) || (status_byte == 51))
      {
        xil_printf("Magnet position OK! \n");
      }
      else if (status_byte == 39)
      {
        xil_printf("Magnet too strong, move away.\n");
      }
      else
      {
        xil_printf("Encoder status reg: %d \n", status_byte);
      }

      usleep(250000);
    }

    GetAngle();					// Get initial angle of encoder
	start_angle = deg_angle;	// Save it for correcting all future readings


    write_led_values(DISPLAY_CONFIG, DISPLAY_REGISTER, led_array, LED_ARRAY_LEN);   // Initialize the first buffer with data

                                      // Data is automatically shifted into the second buffer upon write complete (in write_led_values)

    *(DISPLAY_CONFIG) = 0x00001100;   // Synchronize (0 degrees) and next angle. Shift it to third and final buffer so it can be written out.


    unsigned int written_angles = 1;

    while(1)
    {
        write_led_values(DISPLAY_CONFIG, DISPLAY_REGISTER, led_array, LED_ARRAY_LEN);
        if (debug_encoder) xil_printf("starting loop\n");

		GetAngle();
		CorrectAngle();
		first_angle_after_update = corrected_angle;

        while (written_angles < NUM_ANGLES)  // Cast to int to round to nearest degree
        {
            GetAngle();
		    CorrectAngle();

		    if (debug_encoder) xil_printf("Corrected Angle: %d\n", (int)corrected_angle);

            if ((corrected_angle - first_angle_after_update) >= update_width)
            {
            	if (debug_encoder) xil_printf("Next angle.\n");

				first_angle_after_update = corrected_angle;

            	*(DISPLAY_CONFIG) = 0x00000100;       // next angle
            	written_angles += 1;
            }

			if ((last_angle == 0) && (corrected_angle > 0))
			{
				skipped_angle = 1;
				break;
			}
        }

        *(DISPLAY_CONFIG) = 0x00001100;       // Synchronize (0 degrees)

		if (skipped_angle == 1)
		{
			written_angles = 1;
			skipped_angle = 0;
		}
		else
		{
			written_angles = 0;
		}
    }

    cleanup_platform();
    return 0;
}

void write_led_values( volatile u32* config_addr, volatile u32* register_addr, u8* led_array, unsigned int led_array_len ) {

    unsigned int packed_data;
    //unsigned int pack_state = 0;

    for ( int i=0; i < led_array_len; i=i+4 ) {
    /*								Don't need packing shite when using 6-bit color
        switch (pack_state) {

            case 0:

                // 4 bytes free, pack 3 bytes
                packed_data = led_array[i];
                pack_state = 1;

                // send if end of array
                if ( i == led_array_len-1 ) { *register_addr = packed_data; }

            break;

            case 1:

                // 1 byte free, pack one byte
                packed_data = packed_data | (led_array[i] << 24) ;
                pack_state = 2;

                // send finished word
                *register_addr = packed_data;

                // pack the remaining 2 bytes
                packed_data = led_array[i] >> 8;

            break;

            case 2:

                // 2 bytes free, pack next 2 bytes
                packed_data = packed_data | (led_array[i] << 16);
                pack_state = 3;

                // send finished word
                *register_addr = packed_data;

                // pack the remaining 1 byte
                packed_data = led_array[i] >> 16;

            break;

            case 3:

                // 3 bytes free, pack 3 bytes
                packed_data = packed_data | (led_array[i] << 8);
                pack_state = 0;

                // send finished word
                *register_addr = packed_data;

            break;

        } */
    	packed_data = 0;
    	packed_data = led_array[i+3] | (led_array[i+2] << 8) | (led_array[i+1] << 16) | (led_array[i] << 24);

    	*register_addr = packed_data;
    }

    // send write complete
    *(config_addr) = 0x00000001;
}


// ************************** Function Definitions ******************************


void GetAngle()
{
	ReadIIC(&i2c, 0x0D, &angle_low_byte, 1);		// Read low byte of angle
	ReadIIC(&i2c, 0x0C, &angle_high_byte, 1);		// Read high byte of angle

	//xil_printf("high: %d, low: %d\n", angle_high_byte, angle_low_byte);

	raw_angle = 0;
	raw_angle |= angle_high_byte;
	raw_angle = raw_angle << 8;
	raw_angle |= angle_low_byte;

	deg_angle = raw_angle * 0.087890625;		// (360/4096) - 12-bit resolution of encoder

	if (debug_encoder) xil_printf("Deg. Angle: %d\n", (unsigned int)deg_angle);
}


void CorrectAngle()
{
	last_angle = corrected_angle; 						// Save last angle
	corrected_angle = deg_angle - start_angle;

	if (corrected_angle < 0) corrected_angle += 360;

    if (corrected_angle >= (360 - kDeadzone))			// Deadzone near zero
    {
    	corrected_angle = 0.0;
    }
}


void ReadIIC(XIic* InstancePtr, u8 reg, u8 *Data, int nData)
{
	if (nData != 1) {
		xil_printf("ReadIIC only setup for single byte reads currently.\n");
		return;
	}

	int Status;
	Status = XIic_Start(InstancePtr);
	if (Status != XST_SUCCESS) {
		xil_printf("XIic_Start in ReadIIC failed.\n");
		return;
	}
	//xil_printf("XIic_Start in ReadIIC success.\n");


	XIic_Send(IIC_BASE_ADDRESS, ENCODER_ID, &reg, 1, XII_GENERAL_CALL_OPTION);
	//xil_printf("XIic_Send in ReadIIC finished.\n");


	XIic_Recv(IIC_BASE_ADDRESS, ENCODER_ID, Data, nData, XIIC_STOP);
	//xil_printf("XIic_Recv in ReadIIC finished.\n");


	Status = XIic_Stop(&i2c);
	if (Status != XST_SUCCESS) {
		xil_printf("XIic_Stop failed!\n");
		return;
	}
	//xil_printf("XIic_Stop in ReadIIC success.\n");

	return;
}
